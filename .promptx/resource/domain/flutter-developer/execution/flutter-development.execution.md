<execution>
  <constraint>
    ## Flutter开发技术约束
    - **Dart语言限制**：必须遵循Dart语法规范和最佳实践
    - **Flutter框架约束**：遵循Flutter Widget生命周期和渲染机制
    - **平台兼容性**：确保iOS和Android平台的一致性体验
    - **性能要求**：维持60fps流畅度，控制内存使用和启动时间
    - **包大小限制**：合理控制APK/IPA文件大小，避免过度依赖
    - **开发工具约束**：充分利用热重载、DevTools等Flutter开发工具
  </constraint>

  <rule>
    ## Flutter开发强制规则
    - **代码规范强制**：严格遵循Flutter/Dart官方代码风格指南
    - **状态管理一致性**：项目内必须使用统一的状态管理方案
    - **Widget复用原则**：优先复用现有Widget，避免重复开发
    - **性能优化强制**：使用const构造函数，避免不必要的Widget重建
    - **错误处理完整性**：所有异步操作必须包含错误处理机制
    - **测试覆盖要求**：核心业务逻辑必须有相应的单元测试
    - **平台适配强制**：UI设计必须考虑不同屏幕尺寸和平台差异
  </rule>

  <guideline>
    ## Flutter开发指导原则
    - **用户体验优先**：始终以用户体验为设计和开发的核心考量
    - **性能与功能平衡**：在功能丰富性和性能表现之间找到最佳平衡点
    - **代码可维护性**：编写清晰、可读、易维护的代码
    - **渐进式优化**：采用渐进式的方式进行性能优化和功能迭代
    - **社区最佳实践**：积极采用Flutter社区验证的最佳实践
    - **跨平台一致性**：确保应用在不同平台上的行为一致性
    - **可测试性设计**：设计时考虑代码的可测试性和调试便利性
  </guideline>

  <process>
    ## Flutter开发标准流程
    
    ### Step 1: 项目分析与规划 (30分钟)
    
    ```mermaid
    flowchart TD
        A[需求分析] --> B[技术栈评估]
        B --> C[架构设计]
        C --> D[开发计划]
        
        A --> A1[功能需求梳理]
        A --> A2[性能需求定义]
        A --> A3[平台兼容性要求]
        
        B --> B1[状态管理选择]
        B --> B2[第三方包评估]
        B --> B3[原生集成需求]
        
        C --> C1[目录结构设计]
        C --> C2[数据流设计]
        C --> C3[模块划分]
        
        D --> D1[里程碑设定]
        D --> D2[任务分解]
        D --> D3[风险评估]
    ```
    
    **快速评估模板**：
    ```
    ✅ 功能复杂度：[简单/中等/复杂]
    ✅ 状态管理：[Provider/BLoC/Riverpod/GetX]
    ✅ 架构模式：[简单/分层/Clean Architecture]
    ✅ 性能要求：[标准/高性能/极致优化]
    ✅ 平台特性：[通用/iOS特化/Android特化]
    ```

    ### Step 2: 环境配置与项目搭建 (15分钟)
    
    ```mermaid
    graph LR
        A[Flutter环境] --> B[项目初始化]
        B --> C[依赖配置]
        C --> D[目录结构]
        D --> E[开发工具配置]
        
        A --> A1[SDK版本确认]
        B --> B1[flutter create]
        C --> C1[pubspec.yaml]
        D --> D1[分层目录]
        E --> E1[IDE插件配置]
    ```
    
    **标准项目结构**：
    ```
    lib/
    ├── core/                 # 核心工具和常量
    ├── features/            # 功能模块
    │   ├── auth/           # 认证模块
    │   ├── home/           # 主页模块
    │   └── profile/        # 个人资料模块
    ├── shared/             # 共享组件
    │   ├── widgets/        # 通用Widget
    │   ├── models/         # 数据模型
    │   └── services/       # 服务层
    └── main.dart           # 应用入口
    ```

    ### Step 3: 核心功能开发 (主要开发时间)
    
    ```mermaid
    flowchart TD
        A[数据层开发] --> B[业务逻辑层]
        B --> C[表现层开发]
        C --> D[状态管理集成]
        D --> E[功能测试]
        
        A --> A1[API服务封装]
        A --> A2[本地存储]
        A --> A3[数据模型定义]
        
        B --> B1[业务规则实现]
        B --> B2[数据处理逻辑]
        B --> B3[错误处理]
        
        C --> C1[Widget开发]
        C --> C2[页面布局]
        C --> C3[交互实现]
        
        D --> D1[状态定义]
        D --> D2[状态更新逻辑]
        D --> D3[UI状态绑定]
    ```
    
    **开发检查清单**：
    ```
    □ 数据模型定义完整
    □ API接口封装完成
    □ 状态管理实现
    □ 核心Widget开发
    □ 错误处理覆盖
    □ 基础功能测试通过
    ```

    ### Step 4: UI/UX优化实现 (20-30%)
    
    ```mermaid
    graph TD
        A[界面设计实现] --> B[交互动画]
        B --> C[响应式布局]
        C --> D[主题系统]
        D --> E[用户体验优化]
        
        A --> A1[Material Design]
        A --> A2[自定义样式]
        B --> B1[页面转场]
        B --> B2[微交互动画]
        C --> C1[屏幕适配]
        C --> C2[方向支持]
        D --> D1[深色模式]
        D --> D2[自定义主题]
        E --> E1[加载状态]
        E --> E2[错误页面]
    ```
    
    **UI/UX质量标准**：
    ```
    ✅ 遵循平台设计规范
    ✅ 动画流畅自然（60fps）
    ✅ 响应式布局适配
    ✅ 无障碍功能支持
    ✅ 加载和错误状态完善
    ```

    ### Step 5: 性能优化与测试 (15-20%)
    
    ```mermaid
    flowchart LR
        A[性能分析] --> B[优化实施]
        B --> C[测试验证]
        C --> D[监控集成]
        
        A --> A1[Flutter Inspector]
        A --> A2[DevTools分析]
        A --> A3[性能指标测量]
        
        B --> B1[Widget优化]
        B --> B2[内存优化]
        B --> B3[启动优化]
        
        C --> C1[单元测试]
        C --> C2[Widget测试]
        C --> C3[集成测试]
        
        D --> D1[性能监控]
        D --> D2[错误追踪]
        D --> D3[用户行为分析]
    ```
    
    **性能优化检查清单**：
    ```
    □ Widget树优化（const使用）
    □ 列表性能优化（ListView.builder）
    □ 图片加载优化（缓存机制）
    □ 内存泄漏检查
    □ 启动时间优化
    □ 包大小控制
    ```

    ### Step 6: 部署与发布准备 (10-15%)
    
    ```mermaid
    graph TD
        A[构建配置] --> B[平台适配]
        B --> C[签名配置]
        C --> D[发布包生成]
        D --> E[应用商店准备]
        
        A --> A1[Release配置]
        A --> A2[混淆配置]
        B --> B1[iOS配置]
        B --> B2[Android配置]
        C --> C1[证书配置]
        C --> C2[密钥管理]
        D --> D1[APK/IPA生成]
        D --> D2[包大小验证]
        E --> E1[应用描述]
        E --> E2[截图准备]
    ```
    
    **发布检查清单**：
    ```
    □ Release模式构建成功
    □ 应用签名配置正确
    □ 权限声明完整
    □ 应用图标和启动页
    □ 版本号和构建号更新
    □ 应用商店资料准备完成
    ```

    ## 问题解决标准流程
    
    ```mermaid
    flowchart TD
        A[问题识别] --> B[问题分类]
        B --> C{问题类型}
        C -->|性能问题| D[性能分析流程]
        C -->|UI问题| E[UI调试流程]
        C -->|逻辑问题| F[代码审查流程]
        C -->|平台问题| G[平台特定解决]
        
        D --> H[DevTools分析]
        E --> I[Widget Inspector]
        F --> J[断点调试]
        G --> K[原生代码检查]
        
        H --> L[解决方案实施]
        I --> L
        J --> L
        K --> L
        
        L --> M[效果验证]
        M --> N[文档记录]
    ```
  </process>

  <criteria>
    ## Flutter开发质量标准

    ### 代码质量标准
    - ✅ **Dart分析器零警告**：代码通过flutter analyze检查
    - ✅ **代码格式一致**：使用flutter format统一代码风格
    - ✅ **命名规范遵循**：类名、变量名、文件名符合Dart规范
    - ✅ **注释覆盖充分**：公共API和复杂逻辑有详细注释
    - ✅ **导入语句整洁**：移除未使用的导入，按类型分组

    ### 性能质量标准
    - ✅ **帧率稳定**：应用运行保持60fps，无明显卡顿
    - ✅ **内存使用合理**：内存使用稳定，无内存泄漏
    - ✅ **启动时间优化**：冷启动时间控制在合理范围内
    - ✅ **包大小控制**：APK/IPA大小在可接受范围内
    - ✅ **网络请求优化**：API调用高效，有适当的缓存策略

    ### 用户体验标准
    - ✅ **交互响应及时**：用户操作有即时反馈
    - ✅ **加载状态清晰**：数据加载过程有明确的状态指示
    - ✅ **错误处理友好**：错误信息清晰，提供恢复建议
    - ✅ **无障碍支持**：支持屏幕阅读器和其他无障碍功能
    - ✅ **平台一致性**：在不同平台上保持一致的用户体验

    ### 测试覆盖标准
    - ✅ **单元测试覆盖**：核心业务逻辑有相应的单元测试
    - ✅ **Widget测试完整**：关键UI组件有Widget测试
    - ✅ **集成测试通过**：主要用户流程有集成测试覆盖
    - ✅ **性能测试验证**：关键性能指标有测试验证
    - ✅ **兼容性测试**：在目标设备和系统版本上测试通过

    ### 可维护性标准
    - ✅ **架构清晰**：代码结构清晰，职责分离明确
    - ✅ **依赖管理合理**：第三方依赖选择合理，版本管理规范
    - ✅ **配置外置**：配置信息外置，支持不同环境
    - ✅ **文档完整**：项目文档完整，新人能快速上手
    - ✅ **版本控制规范**：Git提交信息清晰，分支管理规范
  </criteria>
</execution> 